<!doctype html>
<html lang="en" data-theme="dark">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>BabylonJS 3D Designer</title>
	<link rel="stylesheet" href="./src/style.css">
</head>
<body class="flex flex-col h-screen w-screen bg-base-300 text-base-content font-sans overflow-hidden">

<!-- Top Menubar -->
<nav class="h-12 bg-base-100 border-b border-base-content/10 flex items-center px-4 gap-2 flex-none z-10">
	<div class="font-bold text-lg mr-4 text-primary">BabylonDesigner</div>
	
	<!-- Gizmo Controls -->
	<div class="join mr-4">
		<button id="btn-gizmo-pos" class="btn btn-sm join-item btn-active" title="Position Gizmo">Pos</button>
		<button id="btn-gizmo-rot" class="btn btn-sm join-item" title="Rotation Gizmo">Rot</button>
		<button id="btn-gizmo-scl" class="btn btn-sm join-item" title="Scale Gizmo">Scl</button>
	</div>
	
	<div class="join">
		<button id="btn-menu-new" class="btn btn-sm join-item">New</button>
		<button id="btn-menu-save" class="btn btn-sm join-item">Save</button>
		<button id="btn-menu-load" class="btn btn-sm join-item">Load</button>
	</div>
</nav>

<!-- Main Workspace -->
<div class="flex-1 flex overflow-hidden">
	<!-- Left Sidebar: Assets -->
	<div class="w-64 flex-none bg-base-200 p-4 border-r border-base-content/10 flex flex-col gap-4 overflow-y-auto">
		<h2 class="text-xl font-bold mb-2">Primitives</h2>
		<div id="primitives-list" class="grid grid-cols-2 gap-2">
			<!-- Draggables generated by JS -->
		</div>
		
		<h2 class="text-xl font-bold mt-4 mb-2">Lights</h2>
		<div id="lights-list" class="grid grid-cols-2 gap-2">
			<!-- Draggables generated by JS -->
		</div>
		
		<div class="mt-auto">
			<button id="btn-open-mat-editor" class="btn btn-primary w-full">Material Editor</button>
		</div>
	</div>
	
	<!-- Center: Scene -->
	<div class="flex-1 relative bg-black">
		<canvas id="renderCanvas" class="w-full h-full touch-none"></canvas>
		<div class="absolute top-4 left-4 bg-base-100/80 p-2 rounded backdrop-blur pointer-events-none">
			<p class="text-xs">Drag items from left. Click to select.</p>
		</div>
	</div>
	
	<!-- Right Sidebar: Properties -->
	<div class="w-80 flex-none bg-base-200 flex flex-col border-l border-base-content/10 overflow-hidden">
		<!-- Hierarchy / Tree View -->
		<div class="flex-none h-1/3 flex flex-col border-b border-base-content/10">
			<h2 class="text-sm font-bold p-2 bg-base-300">Scene Hierarchy</h2>
			<div id="scene-explorer" class="flex-1 overflow-y-auto p-2 text-sm select-none">
				<!-- Tree populated by JS -->
			</div>
		</div>
		
		<!-- Properties Editor -->
		<div class="flex-1 overflow-y-auto p-4">
			<h2 class="text-xl font-bold mb-4">Properties</h2>
			<div id="property-editor" class="flex flex-col gap-3 opacity-50 pointer-events-none">
				
				<!-- ID -->
				<label class="form-control w-full">
					<div class="label"><span class="label-text">ID</span></div>
					<input type="text" id="prop-id" class="input input-bordered w-full input-sm" />
				</label>
				
				<!-- Parent -->
				<label class="form-control w-full">
					<div class="label"><span class="label-text">Parent</span></div>
					<select id="prop-parent" class="select select-bordered w-full select-sm"></select>
				</label>
				
				<!-- Material -->
				<label class="form-control w-full">
					<div class="label"><span class="label-text">Material</span></div>
					<select id="prop-material" class="select select-bordered w-full select-sm"></select>
				</label>
				
				<div class="divider my-1"></div>
				
				<!-- Transforms Helper -->
				<div id="transform-container"></div>
			
			</div>
		</div>
	</div>
</div>

<!-- Bottom Status Bar -->
<footer class="h-6 bg-base-100 border-t border-base-content/10 flex items-center px-4 text-xs select-none flex-none">
	<span class="opacity-70 mr-2">Status:</span>
	<span id="status-text" class="font-mono font-bold">Untitled</span>
</footer>

<!-- Material Editor Modal -->
<dialog id="material_modal" class="modal">
	<div class="modal-box w-11/12 max-w-5xl">
		<h3 class="font-bold text-lg">Material Editor (PBR)</h3>
		
		<div class="flex gap-4 mt-4 h-96">
			
			<!-- Left: Material List -->
			<div class="w-1/4 flex flex-col gap-2 border-r border-base-content/10 pr-2">
				<button id="btn-new-material" class="btn btn-sm btn-outline btn-success w-full">+ New Material</button>
				<div class="divider my-0"></div>
				<div id="material-list" class="flex-1 overflow-y-auto flex flex-col gap-1">
					<!-- Populated by JS -->
				</div>
			</div>
			
			<!-- Center: Preview -->
			<div class="w-1/3 bg-black rounded overflow-hidden relative">
				<canvas id="materialPreviewCanvas" class="w-full h-full"></canvas>
			</div>
			
			<!-- Right: Controls -->
			<div class="w-1/3 flex flex-col gap-2 overflow-y-auto pr-2 pl-2">
				<label class="input input-bordered flex items-center gap-2 input-sm">
					Name <input type="text" id="mat-name" class="grow" value="New Material" />
				</label>
				
				<label class="label cursor-pointer justify-start gap-2">
					<span class="label-text w-24">Albedo</span>
					<input type="color" id="mat-albedo" class="h-8 w-full" value="#ffffff" />
				</label>
				
				<label class="label cursor-pointer justify-start gap-2">
					<span class="label-text w-24">Emissive</span>
					<input type="color" id="mat-emissive" class="h-8 w-full" value="#000000" />
				</label>
				
				<div class="flex flex-col">
					<span class="label-text text-xs">Metallic</span>
					<input type="range" id="mat-metallic" min="0" max="1" step="0.01" value="0" class="range range-xs" />
				</div>
				
				<div class="flex flex-col">
					<span class="label-text text-xs">Roughness</span>
					<input type="range" id="mat-roughness" min="0" max="1" step="0.01" value="1" class="range range-xs" />
				</div>
				
				<div class="flex flex-col">
					<span class="label-text text-xs">Alpha</span>
					<input type="range" id="mat-alpha" min="0" max="1" step="0.01" value="1" class="range range-xs" />
				</div>
			
			</div>
		</div>
		<div class="modal-action">
			<form method="dialog">
				<button class="btn">Close</button>
				<button id="btn-create-material" class="btn btn-primary">Create / Update</button>
			</form>
		</div>
	</div>
</dialog>

<!-- Save/Load Scene Modal -->
<dialog id="save_load_modal" class="modal">
	<div class="modal-box">
		<h3 id="modal-title" class="font-bold text-lg mb-4">Manage Scenes</h3>
		
		<!-- File List -->
		<div class="border border-base-content/20 rounded p-2 h-48 overflow-y-auto flex flex-col gap-1 mb-4" id="scene-list">
			<!-- Populated by JS -->
		</div>
		
		<!-- Save Input -->
		<label class="input input-bordered flex items-center gap-2 mb-4">
			Filename
			<input type="text" id="save-scene-name" class="grow" placeholder="my_scene" />
			<span class="badge badge-info">.json</span>
		</label>
		
		<div class="modal-action">
			<form method="dialog">
				<button class="btn">Cancel</button>
			</form>
			<button id="btn-modal-save" class="btn btn-success">Save</button>
		</div>
	</div>
</dialog>

<script type="module" src="/src/main.js"></script>
</body>
</html>
